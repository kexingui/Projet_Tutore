# -*- coding: utf-8 -*-
"""split_csv_lines

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/14GEqcKziMxZBQnTGD5ZvJl9TcupVp2mW
"""

import csv
import os

def split_csv_lines(input_file, output_file):
    with open(input_file, 'r', newline='') as csvfile:
        reader = csv.DictReader(csvfile)

        with open(output_file, 'w', newline='') as outfile:
            fieldnames = reader.fieldnames
            writer = csv.DictWriter(outfile, fieldnames=fieldnames)
            writer.writeheader()

            for row in reader:
                content = row['content']
                if '\n' in content:
                    lines = content.split('\n')
                    for line in lines:
                        new_row = row.copy()
                        new_row['content'] = line.strip()
                        writer.writerow(new_row)
                else:
                    writer.writerow(row)


if __name__ == "__main__":
    source_file = '001dataset_complet_last_version+genre.csv'
    output_file = 'dataset_splitted_lines.csv'
    split_csv_lines(source_file, output_file)